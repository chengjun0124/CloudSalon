app.controller("service_purchase",["$scope","serviceAPIService","$stateParams","dialogService","purchasedServiceAPIService","dialogService",function(n,t,i,r,u,r){n.userId=i.userId;n.serviceId=i.serviceId;n.title="购买服务";n.routeName="service_select/"+n.userId;n.service=null;n.purchase={payment:null,time:null,mode:null,serviceId:n.serviceId,userId:n.userId};n.isPreview=!1;t.getService(n.serviceId).then(function(t){n.service=t.data;n.painStars=[];for(var i=0;i<t.data.pain;i++)n.painStars.push(i)});n.selectMode=function(t){n.purchase.mode=t;t==0?(n.purchase.payment=n.service.oncePrice,n.purchase.time=1):t==1&&(n.purchase.payment=n.service.treatmentPrice,n.purchase.time=n.service.treatmentPrice?n.service.treatmentTime:null)};n.submit=function(){u.createPurchasedService(n.purchase).then(function(){r.showMention(1,"购买服务成功","user",{userId:n.userId})})}}]);